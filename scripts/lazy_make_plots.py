
import numpy as np

import os

import h5py


import matplotlib
from matplotlib import pyplot as plt


from scipy.optimize import curve_fit

#R position binned in towall
'''
list_1=[ 6.46213428 ,7.33181152 ,8.08074414 ,8.43328162 ,8.7308902 , 9.02174706,
 8.8202713 , 9.16820648 ,8.97289352 ,9.12921716 ,9.13364853 ,9.14690796,
 9.36193091 ,9.32408621 ,9.0955831 , 8.91250269 ,8.75788118 ,8.79312897,
 8.82161847 ,9.11448605 ,9.03970261 ,9.57974005 ,9.69019348 ,9.737405,
 9.85301025 ,9.9814436 , 9.74635269 ,9.76127214 ,9.95110689, 10.09010205,
 10.03867236, 10.17409363, 9.77563977, 9.23288947, 9.36827173, 9.74976074,
 9.6696969 ,9.18061197, 9.11892426, 9.76913055]
list_2=[13.62287634, 11.99070557, 11.34333035, 11.05452625, 10.07466248, 10.35578021,
 10.03709326, 10.13654938 ,9.84700061, 10.10674658 ,9.97388403 ,9.92899188,
 9.93667188 ,9.84772827 ,9.33994159 ,9.84084894 ,9.67059647 ,9.73241389,
 9.82965964, 10.2191868 ,10.45426654, 10.3808345 ,10.74603119, 10.26511185,
 10.72213582, 11.13159048, 10.81644788, 11.32662634, 11.1236066, 11.11496072,
 12.14370412, 11.32500229, 12.205909 , 12.06560364, 12.65490509, 13.19485379,
 11.65981152, 12.03559485, 12.12894971, 12.09604102]
'''

#R Position binned in ve
'''
list_1 = [15.79786386, 11.05308484,  9.76187775,  8.80132187,  8.51439442,  8.11833652,
  8.02139752,  7.87485199,  7.79288114,  7.7573233 ]
list_2 = [12.85806671, 10.24152029, 10.06046364,  9.85629419, 10.31376865, 10.32565208,
 10.65015857, 10.61911748, 10.90470081, 11.15156494]
x_axis = [   0.,  100.,  200.,  300.,  400.,  500.,  600.,  700.,  800.,  900., 1000.,]
'''

#R position binned in nhits
'''
list_1 = [13.48760759, 10.54835199,  9.85342993,  9.2266073,   8.74169565,  8.50393512,
  8.49426465,  8.14035403,  8.21566064,  8.31966331,  8.10291313,  8.2538548,
  8.11999458,  8.59463867,  8.64076294,  9.25094904,  9.36362,    10.22192627,
 10.49916205, 10.78795975]
list_2 = [14.73460846, 12.40147687, 11.02505087, 10.44470367, 10.35599805, 10.11399377,
 9.87542957,  9.63184265,  9.57079834,  9.63560854,  9.83315358,  9.92602197,
 9.47122736, 10.1535593,  10.28110944, 11.01636864, 11.97623317, 12.88630948,
 13.87033844, 15.52341315]
x_axis = [ 200.,          408.69565217,  617.39130435,  826.08695652, 1034.7826087,
 1243.47826087, 1452.17391304, 1660.86956522, 1869.56521739, 2078.26086957,
 2286.95652174, 2495.65217391, 2704.34782609, 2913.04347826, 3121.73913043,
 3330.43478261, 3539.13043478, 3747.82608696, 3956.52173913, 4165.2173913,
 4373.91304348]
'''

#Momentum bias in ve
list_1=[-0.6799999999999999, 0.11399999999999999, 0.257, 0.5740000000000001, 0.468, 0.506, 0.67, 0.743, 0.8920000000000001, 1.53]
list_2=[0.167, 1.238, 1.195, 1.046, 0.8009999999999999, 0.6930000000000001, 0.45599999999999996, 0.439, 0.132, 0.131]

#Momentum resolution in ve
#list_1=[7.351432756696741, 5.045700404739336, 4.1832897645511995, 3.657899074679665, 3.344515880671559, 3.1273514074987547, 2.907489700093276, 2.8141864881707104, 2.6990975791718754, 2.429693703674958]
#list_2= [8.838237662531533, 6.2756620514031605, 5.097450792579945, 4.683185812947217, 4.379154609100287, 4.155402430734302, 4.0380433377034795, 3.885081700007368, 3.7867119373658316, 3.578631892960873]
#x_axis = [   0.,  100.,  200.,  300.,  400.,  500.,  600.,  700.,  800.,  900., 1000.,]

#Direction R bias in ve
#list_1 = [ 1.58e-03,  4.80e-04,  1.80e-04, -2.10e-04, -1.70e-04, -2.60e-04, -4.10e-04,
# -1.00e-05, -4.20e-04, -8.00e-05]
#list_2 = [-2.3e-04, -4.6e-04, -1.0e-05, -1.7e-04, -2.8e-04, -2.1e-04, -6.0e-05, -2.7e-04,
# -3.6e-04, -1.6e-04]

#Direction Z bias in ve
#x_axis = [   0.,  100.,  200.,  300.,  400.,  500.,  600.,  700.,  800.,  900., 1000.,]
#list_1  = [0.00256, 0.00178, 0.00174, 0.00172, 0.00173, 0.00167, 0.00148, 0.00179, 0.00184,
# 0.00169]
#list_2 = [-2.7e-04,  9.0e-05,  1.4e-04, -2.0e-04,  6.0e-05, -6.0e-05, -2.4e-04,  5.7e-04,
#  1.9e-04, -2.5e-04]

#Direction R towall bias 
'''
list_2 [-1.10e-04, -7.20e-04, -1.04e-03, -9.30e-04, -5.50e-04, -5.90e-04, -3.40e-04,
 -1.10e-04, -3.70e-04, -2.30e-04, -3.40e-04, -6.40e-04, -7.60e-04, -4.80e-04,
 -2.40e-04, -8.00e-05, -3.90e-04, -1.90e-04, -1.50e-04, -7.00e-04,  2.70e-04,
  1.80e-04, -2.50e-04,  1.60e-04,  3.70e-04, -3.40e-04,  3.90e-04,  6.70e-04,
  7.10e-04,  3.60e-04,  9.10e-04,  1.20e-04,  6.80e-04,  7.90e-04,  5.60e-04,
 -2.00e-04, -3.40e-04,  1.00e-03,  5.30e-04,  2.30e-04]
'''

#Direection Z towall bias
x_axis = [   0.,  100.,  200.,  300.,  400.,  500.,  600.,  700.,  800.,  900., 1000., 1100.,
 1200., 1300., 1400., 1500., 1600., 1700., 1800., 1900., 2000., 2100., 2200., 2300.,
 2400., 2500., 2600., 2700., 2800., 2900., 3000., 3100., 3200., 3300., 3400., 3500.,
 3600., 3700., 3800., 3900., 4000.,]
list_1 = [ 0.0016 ,  0.00247,  0.00176,  0.00192,  0.00212,  0.00154,  0.00237,  0.00203,
  0.00236,  0.00162,  0.00209,  0.00204,  0.00144,  0.00192,  0.00161,  0.00163,
  0.0018,  0.00178,  0.00089,  0.00122,  0.00175,  0.00149,  0.00153,  0.00101,
  0.0019,   0.00117,  0.00136,  0.00108,  0.0014,  0.00142,  0.00135,  0.00185,
  0.00267,  0.00131,  0.00056,  0.00257,  0.00068,  0.00106,  0.00308, -0.00065]
list_2 = [-1.90e-04,  1.10e-03,  3.50e-04,  3.30e-04,  7.20e-04, -2.20e-04,  2.30e-04,
 -3.00e-04,  4.70e-04, -7.20e-04, -2.30e-04,  5.00e-04, -1.00e-05,  7.00e-04,
  2.10e-04, -3.50e-04, -3.00e-05, -2.30e-04, -6.40e-04, -5.60e-04,  4.30e-04,
  6.90e-04, -6.90e-04,  3.40e-04, -3.00e-05, -7.80e-04,  1.00e-04, -6.00e-04,
 -9.80e-04, -2.40e-04, -2.80e-04, -3.10e-04,  6.60e-04,  5.90e-04, -4.50e-04,
 -1.80e-04, -1.03e-03, -2.16e-03,  1.35e-03,  2.30e-04]


x_axis = [x + (x_axis[1]-x_axis[0]) for x in x_axis]
_ = x_axis.pop()

print(len(x_axis))
print(len(list_1))
print(len(list_2))

label_1 = 'ML'
label_2 = 'fiTQun'

xlabel = 'Towall [cm]'
ylabel = 'Direction Z Bias'

name = 'muons_direction_z_bias_tw.png'

plt.scatter(x_axis, list_1, label=label_1, color='blue')
plt.scatter(x_axis, list_2, label=label_2, color='red')
plt.legend()
plt.xlabel(xlabel)
plt.ylabel(ylabel)
plt.savefig("outputs/scan/"+name)
plt.show()